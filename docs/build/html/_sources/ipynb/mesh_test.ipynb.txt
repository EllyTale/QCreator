{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# The full information can be found in this folder:\n",
    "https://github.com/fizikaislove/QCreator/tree/master/Meshing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:04.540665Z",
     "start_time": "2020-08-10T21:17:03.927864Z"
    }
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "\n",
    "# sys.path.append(\"/usr/local/lib/python3.7/site-packages/meshpy\")\n",
    "import meshpy.triangle as triangle\n",
    "import meshpy.tet as tet\n",
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# sys.path.append(\"/usr/local/lib/python3.7/site-packages/gdspy\")\n",
    "import gdspy\n",
    "import subprocess\n",
    "import pandas as pd\n",
    "import pyclipper\n",
    "\n",
    "# module for detecting inner points\n",
    "from shapely.geometry.polygon import Polygon\n",
    "from shapely.geometry import Point"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:05.129190Z",
     "start_time": "2020-08-10T21:17:05.114229Z"
    }
   },
   "outputs": [],
   "source": [
    "def simplify(points):\n",
    "    \"\"\"\n",
    "    Parameters\n",
    "    ----------\n",
    "    pol_points : list(list(coord_x, coord_y))\n",
    "    list of points of WSP\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    list(new_polygon_1, ...), where\n",
    "    new_polygon_i : list(list(coord_x, coord_y))\n",
    "    \"\"\"\n",
    "    return pyclipper.SimplifyPolygon(points)\n",
    "\n",
    "\n",
    "def round_trip_connect(start, end):\n",
    "    return [(i, i + 1) for i in range(start, end)] + [(end, start)]\n",
    "\n",
    "\n",
    "def inner_point(polygon):\n",
    "    point = Polygon(polygon).representative_point()\n",
    "    x, y = point.x, point.y\n",
    "    return x, y\n",
    "\n",
    "\n",
    "def create_mesh(WSP_points, max_volume=10000, min_angle=25):\n",
    "    outer_polygon, *inner_polygons = simplify(WSP_points)\n",
    "    inner_points_of_holes = [inner_point(pol) for pol in inner_polygons]\n",
    "    \n",
    "    points = outer_polygon\n",
    "    \n",
    "    last_point_number = len(outer_polygon) - 1\n",
    "    facets = round_trip_connect(0, last_point_number)\n",
    "    \n",
    "    for pol in inner_polygons:\n",
    "        points.extend(pol)\n",
    "        facets.extend(round_trip_connect(last_point_number+1, last_point_number+len(pol)))\n",
    "        last_point_number = last_point_number + len(pol)\n",
    "        \n",
    "    info = triangle.MeshInfo()\n",
    "    info.set_points(points)\n",
    "    info.set_holes(inner_points_of_holes)\n",
    "    info.set_facets(facets)\n",
    "    \n",
    "    mesh = triangle.build(info, max_volume=max_volume, min_angle=min_angle)\n",
    "    \n",
    "    mesh_points = np.array(mesh.points)\n",
    "    mesh_tris = np.array(mesh.elements)\n",
    "    mesh_facets = np.array(mesh.facets)\n",
    "    \n",
    "    return mesh_points, mesh_tris\n",
    "\n",
    "    \n",
    "def plot_mesh(mesh_points,mesh_tris,*arg):\n",
    "    plt.triplot(mesh_points[:, 0], mesh_points[:, 1], mesh_tris,arg)\n",
    "    \n",
    "def write_dat(points,f):\n",
    "    if type(f) is str:\n",
    "            f = open(f, 'w')\n",
    "    counts=len(points)\n",
    "    f.write('0 exported from the LayoutEditor ( www.LayoutEditor.net )\\n')\n",
    "    f.write('* **************************************************\\n')\n",
    "    f.write('* \\n')\n",
    "    f.write('* input file for FastCap automaticly generated by the LayoutEditor\\n')\n",
    "    f.write('* \\n')\n",
    "    f.write('* **************************************************\\n')\n",
    "    for i in range(counts):\n",
    "        f.write('T ')\n",
    "        for j in range(10):\n",
    "            f.write(str(points[i][j]))\n",
    "            f.write(' ')\n",
    "        f.write('\\n')\n",
    "    f.write('*')\n",
    "    f.close()\n",
    "def to_fastcap(mesh_points,mesh_tris,number):\n",
    "    z=np.zeros((len(mesh_points[:, 0]),))\n",
    "    to_output=list()\n",
    "    for i in range(len(mesh_points[:, 0])):\n",
    "        to_output.append([mesh_points[i, 0], mesh_points[i, 1],z[i]])\n",
    "    test=[]\n",
    "    for index in range(len(mesh_tris)):\n",
    "        test.append(np.asarray([to_output[mesh_tris[index][2]],to_output[mesh_tris[index][1]],to_output[mesh_tris[index][0]]]))\n",
    "    test=np.asarray(test)\n",
    "    points_file=test.reshape((len(mesh_tris),9))\n",
    "    points_to_file=np.insert(points_file,0,number,axis=1)\n",
    "    return points_to_file\n",
    "    \n",
    "  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Read conductors from a gds file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:08.168568Z",
     "start_time": "2020-08-10T21:17:08.119141Z"
    }
   },
   "outputs": [],
   "source": [
    "layers=[0,1,2,3]\n",
    "new_cells=[gdspy.GdsLibrary()]*len(layers)\n",
    "cells=[]\n",
    "cell_name='result'\n",
    "path=r\"E:\\Github\\QCreator\\Meshing\\test1.gds\"\n",
    "for i,num_layer in enumerate(layers):\n",
    "    cells.append(new_cells[i].read_gds(infile=path).cell_dict[cell_name])\n",
    "    cells[i].remove_polygons(lambda pts, layer, datatype:layer != i)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Use this cell to check the correctness of the studied conductors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:11:16.651166Z",
     "start_time": "2020-08-10T21:11:12.136403Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<gdspy.viewer.LayoutViewer object .!layoutviewer>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num=1\n",
    "gdspy.LayoutViewer(cells=cells[num])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Preparation of the conductors to the meshpy format"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:11.725508Z",
     "start_time": "2020-08-10T21:17:11.711915Z"
    }
   },
   "outputs": [],
   "source": [
    "conductors=[]\n",
    "def create_cond(cell):\n",
    "    polygons=[]\n",
    "    for fig in cell.get_polygons():\n",
    "        polygons.append([tuple(fig[i]) for i in range(len(fig))])\n",
    "    return polygons\n",
    "for i in range(len(layers)):\n",
    "    conductors.append(create_cond(cells[i]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Meshing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:14.766808Z",
     "start_time": "2020-08-10T21:17:14.223437Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "For 0 conductor total length is:  104346\n",
      "For 1 conductor total length is:  4386\n",
      "For 2 conductor total length is:  4887\n",
      "For 3 conductor total length is:  4905\n",
      "Sum : 118524\n"
     ]
    }
   ],
   "source": [
    "meshpy_volume=10\n",
    "mesh_figures_points=[]\n",
    "mesh_figures_tris=[]\n",
    "total=0\n",
    "for num, polygons in enumerate(conductors):\n",
    "    mesh_points_list = []\n",
    "    mesh_tris_list = []\n",
    "    total_length=0\n",
    "    for conductor, volume in zip(polygons, [meshpy_volume]*len(polygons)):\n",
    "        data = create_mesh(conductor, max_volume=volume)\n",
    "        mesh_points_list.append(data[0])\n",
    "        mesh_tris_list.append(data[1])\n",
    "        total_length+=len(data[1])\n",
    "    total+=total_length\n",
    "    mesh_figures_points.append(mesh_points_list)\n",
    "    mesh_figures_tris.append(mesh_tris_list)\n",
    "    print('For '+str(num)+' conductor '+'total length is: ', total_length)\n",
    "print(\"Sum :\",total)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T12:22:45.420098Z",
     "start_time": "2020-08-10T12:22:45.380301Z"
    }
   },
   "outputs": [],
   "source": [
    "%matplotlib qt5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:38.803548Z",
     "start_time": "2020-08-10T21:17:38.326134Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "colors=['r','b','k','g']\n",
    "for num,color in enumerate(colors):\n",
    "    for i in range(len(conductors[num])):\n",
    "        plot_mesh(mesh_figures_points[num][i],mesh_figures_tris[num][i],color)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Write into a file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:43.165793Z",
     "start_time": "2020-08-10T21:17:42.746312Z"
    }
   },
   "outputs": [],
   "source": [
    "list_of_conductors_to_fastcap=[]\n",
    "for num in range(len(conductors)):\n",
    "    for mesh_points,mesh_tris in zip(mesh_figures_points[num],mesh_figures_tris[num]):\n",
    "    #     number+=1\n",
    "        list_of_conductors_to_fastcap.append(to_fastcap(mesh_points,mesh_tris,num+1))\n",
    "joined_data=np.concatenate(tuple(list_of_conductors_to_fastcap))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:17:47.121239Z",
     "start_time": "2020-08-10T21:17:44.539423Z"
    }
   },
   "outputs": [],
   "source": [
    "filename = r\"E:\\Github\\QCreator\\Meshing\\1_attempt\"\n",
    "write_dat(joined_data,filename)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Run fastcap with the created mesh file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:19:10.963933Z",
     "start_time": "2020-08-10T21:17:47.722431Z"
    }
   },
   "outputs": [],
   "source": [
    "output_file_name=r\"E:\\Github\\QCreator\\Meshing\\1_attempt_results\"\n",
    "output_file = open(output_file_name, 'w')\n",
    "args = [r\"C:\\Program Files (x86)\\LayoutEditor\\bin\\fastcap.exe\",filename]\n",
    "ret=subprocess.call(args,stdout=output_file, shell=False,stderr=subprocess.DEVNULL)\n",
    "output_file.close()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Look into this table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-10T21:21:17.828327Z",
     "start_time": "2020-08-10T21:21:17.802434Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Capacitance value in:  femtofarads\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>428.28000</td>\n",
       "      <td>-129.48000</td>\n",
       "      <td>-46.60035</td>\n",
       "      <td>-46.79332</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-129.48000</td>\n",
       "      <td>159.29775</td>\n",
       "      <td>-7.40152</td>\n",
       "      <td>-7.40152</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>-46.60035</td>\n",
       "      <td>-7.40152</td>\n",
       "      <td>63.61950</td>\n",
       "      <td>-0.12886</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>-46.79332</td>\n",
       "      <td>-7.40152</td>\n",
       "      <td>-0.12886</td>\n",
       "      <td>63.74400</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           0          1         2         3\n",
       "0  428.28000 -129.48000 -46.60035 -46.79332\n",
       "1 -129.48000  159.29775  -7.40152  -7.40152\n",
       "2  -46.60035   -7.40152  63.61950  -0.12886\n",
       "3  -46.79332   -7.40152  -0.12886  63.74400"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "number_of_conductors=len(conductors)\n",
    "with open(output_file_name) as file: \n",
    "    text=file.readlines()\n",
    "    text=[line.rstrip('\\n') for line in text]\n",
    "    value=text[-(number_of_conductors+2)].split(' ')[-1]\n",
    "if value[:4]=='pico': value='femtofarads'\n",
    "print('Capacitance value in: ',value)\n",
    "table=[]\n",
    "def convert(value):\n",
    "    epsilon=(11.45+1)/2\n",
    "    return round(epsilon*float(value),2)/1e3\n",
    "for i in range(-(number_of_conductors),0):\n",
    "    table.append(map(convert,[word for word in text[i].split(' ') if word !=''][-number_of_conductors:]))\n",
    "results=pd.DataFrame(table)\n",
    "results"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
